"use strict";(self.webpackChunkwikidrones=self.webpackChunkwikidrones||[]).push([[4809],{6920:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>i,default:()=>d,frontMatter:()=>c,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"bases_ROS2/structure_de_base","title":"Structure d\'un package ROS2","description":"Qu\'est-ce qu\'un workspace ?","source":"@site/docs/bases_ROS2/structure_de_base.md","sourceDirName":"bases_ROS2","slug":"/bases_ROS2/structure_de_base","permalink":"/WikiDrones/docs/bases_ROS2/structure_de_base","draft":false,"unlisted":false,"editUrl":"https://github.com/VaranusTimorensis/WikiDrones/docs/bases_ROS2/structure_de_base.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"D\xe9couverte de ROS2","permalink":"/WikiDrones/docs/bases_ROS2/ros2"},"next":{"title":"Nodes","permalink":"/WikiDrones/docs/bases_ROS2/nodes"}}');var s=r(4848),o=r(8453);const c={sidebar_position:2},i="Structure d'un package ROS2",t={},l=[{value:"Qu&#39;est-ce qu&#39;un workspace ?",id:"quest-ce-quun-workspace-",level:2},{value:"Qu&#39;est-ce qu&#39;un package ROS 2 ?",id:"quest-ce-quun-package-ros-2-",level:2},{value:"Exemple : cr\xe9er un workspace avec un package",id:"exemple--cr\xe9er-un-workspace-avec-un-package",level:2},{value:"1. Sourcer l&#39;environnement ROS 2",id:"1-sourcer-lenvironnement-ros-2",level:3},{value:"2. Cr\xe9er un nouveau dossier",id:"2-cr\xe9er-un-nouveau-dossier",level:3},{value:"3. Create a package",id:"3-create-a-package",level:3},{value:"4. Build a package",id:"4-build-a-package",level:3},{value:"5. Construire le workspace avec colcon\uf0c1",id:"5-construire-le-workspace-avec-colcon",level:3},{value:"6. Source the overlay\uf0c1",id:"6-source-the-overlay",level:3},{value:"7. Customization of package.xml and CMakeLists.txt",id:"7-customization-of-packagexml-and-cmakeliststxt",level:3}];function u(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"structure-dun-package-ros2",children:"Structure d'un package ROS2"})}),"\n",(0,s.jsx)(n.h2,{id:"quest-ce-quun-workspace-",children:"Qu'est-ce qu'un workspace ?"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.em,{children:["cf ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html",children:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Creating-A-Workspace/Creating-A-Workspace.html"})]})}),"\n",(0,s.jsx)(n.p,{children:"A workspace is a directory containing ROS 2 packages. Before using ROS 2, it\u2019s necessary to source your ROS 2 installation workspace in the terminal you plan to work in. This makes ROS 2\u2019s packages available for you to use in that terminal."}),"\n",(0,s.jsx)(n.p,{children:"You also have the option of sourcing an \u201coverlay\u201d - a secondary workspace where you can add new packages without interfering with the existing ROS 2 workspace that you\u2019re extending, or \u201cunderlay\u201d. Your underlay must contain the dependencies of all the packages in your overlay. Packages in your overlay will override packages in the underlay. It\u2019s also possible to have several layers of underlays and overlays, with each successive overlay using the packages of its parent underlays."}),"\n",(0,s.jsx)(n.h2,{id:"quest-ce-quun-package-ros-2-",children:"Qu'est-ce qu'un package ROS 2 ?"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.em,{children:["cf ",(0,s.jsx)(n.a,{href:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html",children:"https://docs.ros.org/en/jazzy/Tutorials/Beginner-Client-Libraries/Creating-Your-First-ROS2-Package.html"})]}),"\nA package is an organizational unit for your ROS 2 code. If you want to be able to install your code or share it with others, then you\u2019ll need it organized in a package. With packages, you can release your ROS 2 work and allow others to build and use it easily."]}),"\n",(0,s.jsx)(n.p,{children:"Package creation in ROS 2 uses ament as its build system and colcon as its build tool. You can create a package using either CMake or Python, which are officially supported, though other build types do exist."}),"\n",(0,s.jsx)(n.p,{children:"The simplest possible package may have a file structure that looks like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"my_package/\n     CMakeLists.txt\n     include/my_package/\n     package.xml\n     src/\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"CMakeLists.txt"}),": file that describes how to build the code within the package"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"include/<package_name>"}),": directory containing the public headers for the package"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"package.xml"}),": file containing meta information about the package"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"src directory"}),": containing the source code for the package"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"A single workspace can contain as many packages as you want, each in their own folder. You can also have packages of different build types in one workspace (CMake, Python, etc.). You cannot have nested packages."}),"\n",(0,s.jsxs)(n.p,{children:["Best practice is to have a ",(0,s.jsx)(n.code,{children:"src"})," folder within your workspace, and to create your packages in there. This keeps the top level of the workspace \u201cclean\u201d."]}),"\n",(0,s.jsx)(n.p,{children:"A trivial workspace might look like:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"workspace_folder/\n    src/\n      cpp_package_1/\n          CMakeLists.txt\n          include/cpp_package_1/\n          package.xml\n          src/\n\n      py_package_1/\n          package.xml\n          resource/py_package_1\n          setup.cfg\n          setup.py\n          py_package_1/\n      ...\n      cpp_package_n/\n          CMakeLists.txt\n          include/cpp_package_n/\n          package.xml\n          src/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"exemple--cr\xe9er-un-workspace-avec-un-package",children:"Exemple : cr\xe9er un workspace avec un package"}),"\n",(0,s.jsx)(n.h3,{id:"1-sourcer-lenvironnement-ros-2",children:"1. Sourcer l'environnement ROS 2"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"source /opt/ros/foxy/setup.bash"})}),"\n",(0,s.jsx)(n.h3,{id:"2-cr\xe9er-un-nouveau-dossier",children:"2. Cr\xe9er un nouveau dossier"}),"\n",(0,s.jsx)(n.p,{children:"Best practice is to create a new directory for every new workspace. The name doesn\u2019t matter, but it is helpful to have it indicate the purpose of the workspace. Let\u2019s choose the directory name ros2_ws, for \u201cdevelopment workspace\u201d:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mkdir -p ~/ros2_ws/src\ncd ~/ros2_ws/src\n"})}),"\n",(0,s.jsx)(n.p,{children:"Another best practice is to put any packages in your workspace into the src directory. The above code creates a src directory inside ros2_ws and then navigates into it."}),"\n",(0,s.jsx)(n.h3,{id:"3-create-a-package",children:"3. Create a package"}),"\n",(0,s.jsx)(n.p,{children:"The command syntax for creating a new package in ROS 2 is:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ros2 pkg create --build-type ament_cmake --license Apache-2.0 --node-name my_node my_package\n"})}),"\n",(0,s.jsx)(n.p,{children:"You will now have a new folder within your workspace\u2019s src directory called my_package."}),"\n",(0,s.jsx)(n.h3,{id:"4-build-a-package",children:"4. Build a package"}),"\n",(0,s.jsx)(n.p,{children:"Putting packages in a workspace is especially valuable because you can build many packages at once by running colcon build in the workspace root. Otherwise, you would have to build each package individually."}),"\n",(0,s.jsx)(n.p,{children:"Return to the root of your workspace:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cd ~/ros2_ws\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now you can build your packages:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"colcon build\n"})}),"\n",(0,s.jsx)(n.p,{children:"To build only the my_package package next time, you can run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"colcon build --packages-select my_package\n"})}),"\n",(0,s.jsx)(n.h3,{id:"5-construire-le-workspace-avec-colcon",children:"5. Construire le workspace avec colcon\uf0c1"}),"\n",(0,s.jsx)(n.p,{children:"From the root of your workspace (ros2_ws), you can now build your packages using the command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"colcon build\n"})}),"\n",(0,s.jsx)(n.p,{children:"Once the build is finished, enter ls in the workspace root (~/ros2_ws) and you will see that colcon has created new directories:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"build  install  log  src\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"install"})," directory is where your workspace\u2019s setup files are, which you can use to source your overlay."]}),"\n",(0,s.jsx)(n.h3,{id:"6-source-the-overlay",children:"6. Source the overlay\uf0c1"}),"\n",(0,s.jsx)(n.p,{children:"Before sourcing the overlay, it is very important that you open a new terminal, separate from the one where you built the workspace. Sourcing an overlay in the same terminal where you built, or likewise building where an overlay is sourced, may create complex issues."}),"\n",(0,s.jsx)(n.p,{children:"In the new terminal, source your main ROS 2 environment as the \u201cunderlay\u201d, so you can build the overlay \u201con top of\u201d it:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"source /opt/ros/foxy/setup.bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"Go into the root of your workspace:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cd ~/ros2_ws\n"})}),"\n",(0,s.jsx)(n.p,{children:"In the root, source your overlay:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"source install/local_setup.bash\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"NOTE"})}),"\n",(0,s.jsx)(n.p,{children:"Sourcing the local_setup of the overlay will only add the packages available in the overlay to your environment. setup sources the overlay as well as the underlay it was created in, allowing you to utilize both workspaces."}),"\n",(0,s.jsx)(n.p,{children:"So, sourcing your main ROS 2 installation\u2019s setup and then the ros2_ws overlay\u2019s local_setup, like you just did, is the same as just sourcing ros2_ws\u2019s setup, because that includes the environment of its underlay."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Now you can run the package from the overlay:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ros2 run <package> <node>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"7-customization-of-packagexml-and-cmakeliststxt",children:"7. Customization of package.xml and CMakeLists.txt"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"TODO"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>i});var a=r(6540);const s={},o=a.createContext(s);function c(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);